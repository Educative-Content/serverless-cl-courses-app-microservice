{"ast":null,"code":"import _regeneratorRuntime from\"/Users/Zainab/Desktop/MicroservicesLab/CRUDCourses/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/Zainab/Desktop/MicroservicesLab/CRUDCourses/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/Zainab/Desktop/MicroservicesLab/CRUDCourses/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import axios from'axios';export default function useFetch(queryField,queryAttributesStr){// Declaring the essential state variables for data and checking\n// if the request is loading or succeeded\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),success=_useState4[0],setSuccess=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var controller=new AbortController();useEffect(function(){// Changing loading and success state to true whenever there's an effect\nsetLoading(true);setSuccess(false);// Extracting data from queryAttributesStr\nvar queryAttributes=JSON.parse(queryAttributesStr);var options={headers:{'content-type':'text/plain'}};function CRUDOperations(requestField,inputData,signal){if(requestField==='addCourse'){axios.post(\"http://localhost:3002/api/createcourse\",inputData,{signal:signal}).then(function(response){console.log(response);if(response.status!==200){alert(\"Server Error: Course creation failed.\");}}).catch(function(error){console.error(\"Network Error:\",error);alert(\"Network Error: Course creation failed.\");});}if(requestField==='editCourse'){axios.put(\"http://localhost:3002/api/updatecourse\",inputData,{signal:signal}).then(function(response){if(response.status!==200){alert(\"Server Error: Course updation failed.\");}}).catch(function(error){console.error(\"Network Error:\",error);alert(\"Network Error: Course updation failed.\");});}if(requestField==='removeCourse'){axios.delete(\"http://localhost:3002/api/deletecourse/\".concat(inputData.id),{signal:signal}).then(function(response){console.log(response);if(response.status!==200){alert(\"Server Error: Course deletion failed.\");}}).catch(function(error){console.error(\"Network Error:\",error);});}}// asynchronous function to make API call\nfunction fetchData(){return _fetchData.apply(this,arguments);}// Making sure that a null field is not passed\nfunction _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var signal,response,errorMessage;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;signal=controller.signal;if(!(queryField!==\"allCourses\")){_context.next=5;break;}_context.next=5;return CRUDOperations(queryField,queryAttributes,signal);case 5:_context.next=7;return axios.get('http://localhost:3002/api/getcourses',{signal:signal});case 7:response=_context.sent;if(!(response.status===200)){_context.next=13;break;}setSuccess(true);setData(response);// Storing response data\n_context.next=15;break;case 13:errorMessage=response.data.errorMessage||response.data.statusText;throw new Error(\"Status Code: \".concat(response.status,\"\\nError Message: \").concat(errorMessage));case 15:_context.next=22;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);console.error(_context.t0.message);setData({error:_context.t0.message});setSuccess(false);case 22:_context.prev=22;// Changing loading state to false whenever the API request ends in success or failure\nsetLoading(false);return _context.finish(22);case 25:case\"end\":return _context.stop();}},_callee,null,[[0,17,22,25]]);}));return _fetchData.apply(this,arguments);}if(queryField){fetchData();}else{setLoading(false);setSuccess(true);}// Cancelling the fetch request in case the user navigates\n// away from the screen\nreturn function(){controller.abort();};// Defining variables that trigger useFetch\n},[queryField,queryAttributesStr]);// Returning useFetch response\nreturn{data:data,success:success,loading:loading};}","map":{"version":3,"names":["useState","useEffect","axios","useFetch","queryField","queryAttributesStr","_useState","_useState2","_slicedToArray","data","setData","_useState3","_useState4","success","setSuccess","_useState5","_useState6","loading","setLoading","controller","AbortController","queryAttributes","JSON","parse","options","headers","CRUDOperations","requestField","inputData","signal","post","then","response","console","log","status","alert","catch","error","put","delete","concat","id","fetchData","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","errorMessage","wrap","_callee$","_context","prev","next","get","sent","statusText","Error","t0","message","finish","stop","abort"],"sources":["/Users/Zainab/Desktop/MicroservicesLab/CRUDCourses/frontend/src/hooks/useFetch.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nexport default function useFetch(queryField, queryAttributesStr) {\n  // Declaring the essential state variables for data and checking\n  // if the request is loading or succeeded\n  const [data, setData] = useState(null);\n  const [success, setSuccess] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const controller = new AbortController();\n\n  useEffect(() => {\n    // Changing loading and success state to true whenever there's an effect\n    setLoading(true);\n    setSuccess(false);\n\n    // Extracting data from queryAttributesStr\n    const queryAttributes = JSON.parse(queryAttributesStr);\n    const options = { headers: \n        {\n            'content-type': 'text/plain'\n        }}\n\n    function CRUDOperations(requestField, inputData, signal){\n        if (requestField === 'addCourse'){\n            axios.post(`http://localhost:3002/api/createcourse`, inputData, { signal }).\n            then(response => {\n                console.log(response)\n                if (response.status !== 200) {\n                    alert(\"Server Error: Course creation failed.\");\n                }\n                })\n                .catch(error => {\n                    console.error(\"Network Error:\", error);\n                    alert(\"Network Error: Course creation failed.\");\n                });\n        }\n        if (requestField === 'editCourse'){\n            axios.put(`http://localhost:3002/api/updatecourse`, inputData, { signal }).\n            then(response => {\n                if (response.status !== 200) {\n                    alert(\"Server Error: Course updation failed.\");\n                }\n                })\n                .catch(error => {\n                    console.error(\"Network Error:\", error);\n                    alert(\"Network Error: Course updation failed.\");\n                });\n        }\n        \n        if (requestField === 'removeCourse'){\n\n            axios.delete(`http://localhost:3002/api/deletecourse/${inputData.id}`, { signal }).\n            then(response => {\n                console.log(response)\n            if (response.status !== 200) {\n                alert(\"Server Error: Course deletion failed.\");\n            }\n            })\n            .catch(error => {\n                console.error(\"Network Error:\", error);\n            });\n        }\n    }\n\n    // asynchronous function to make API call\n    async function fetchData() {\n      try {\n        const signal = controller.signal;\n\n        if (queryField !== \"allCourses\"){\n            await CRUDOperations(queryField, queryAttributes, signal)\n        }\n        \n        const response = await axios.get('http://localhost:3002/api/getcourses', { signal });\n\n        // Checking if the request was a success\n        if (response.status === 200) {\n          setSuccess(true);\n          setData(response); // Storing response data\n        } else {\n          const errorMessage = response.data.errorMessage || response.data.statusText;\n          throw new Error(`Status Code: ${response.status}\\nError Message: ${errorMessage}`);\n        }\n      } catch (error) {\n        console.error(error.message);\n        setData({ error: error.message });\n        setSuccess(false);\n      } finally {\n        // Changing loading state to false whenever the API request ends in success or failure\n        setLoading(false);\n      }\n    }\n\n    // Making sure that a null field is not passed\n    if (queryField) {\n      fetchData();\n    } else {\n      setLoading(false);\n      setSuccess(true);\n    }\n\n    // Cancelling the fetch request in case the user navigates\n    // away from the screen\n    return () => {\n      controller.abort();\n    };\n\n    // Defining variables that trigger useFetch\n  }, [queryField, queryAttributesStr]);\n\n  // Returning useFetch response\n  return { data, success, loading };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}